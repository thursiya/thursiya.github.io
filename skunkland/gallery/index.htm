<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Skunkland Server</title>
		<link rel="stylesheet" href="../data/mc.css">
		<link rel="icon" href="../images/pickaxe.png" type="image/x-icon">
		<script src="../data/time.js"></script>
		<script src="../data/header.js"></script>
	</head>
	<body>
		<header><script>insertHeader();</script></header>
		<main>
			<div class="content round shadow">
				<div id="gallerycontent">
					<div class="contentheader round" id="gallery">Random Screenshots</div>
					<div class="row" id="screenshots"></div>
				</div>
				<br><br>
	
				<div class="contentheader round">General Gallery</div>
				<p id="general"></p>
				<div class="row" id="states">
					<div class="col-6">
						<ul>
							<li><a href="Aiur.htm">Kingdom of Aiur</a>
							<li><a href="Amahn.htm">Hanse of Amahn</a>
							<li><a href="Badrum.htm">Imperium of Badrum</a>
							<li><a href="Boatmurdered.htm">Miasma of Boatmurdered</a>
							<li><a href="Braille.htm">Protectorate of Braille</a>
							<li><a href="Crevatia.htm">D.P.R. of Crevatia</a>
						</ul>
					</div>
					<div class="col-6">
						<ul>
							<li><a href="Delve.htm">Adhocracy of Delve</a>
							<li><a href="Faclair.htm">Freenation of Faclair</a>
							<li><a href="Gavel.htm">Republic of Gavel</a>
							<li><a href="Koku.htm">Kingdom of Koku</a>
							<li><a href="Porcinia.htm">Commune of Porcinia</a>
							<li><a href="SouthShore.htm">Commune of South Shore</a>
						</ul>
					</div>
				</div>
			</div>
		</main>
		<script>
			let g;
			loadDoc("https://api.github.com/repos/thursiya/thursiya.github.io/contents/skunkland/gallery/images", getRandomImages);
			loadDoc("../data/gallery.txt", buildGalleryArray);
			
			function loadDoc(url, cFunction) {
  				const xhttp = new XMLHttpRequest();
  				xhttp.onload = function() {cFunction(this);}
  				xhttp.open("GET", url);
  				xhttp.send();
			}

			function getRandomImages(xhr) {
				let pics = JSON.parse(xhr.response);
				for (let i = pics.length - 1; i > 0; i--) {
					let r = ~~(Math.random() * (i + 1));
					[pics[i], pics[r]] = [pics[r], pics[i]];
				}
				let out = "";
				for (let p of pics.splice(-3)) out += `<div class="col-4"><a href="${p.download_url}" target="_blank"><img src="${p.download_url}" height="175" alt="${p.name.slice(0,-4)}"></a></div>`;
				document.getElementById('screenshots').innerHTML = out;
			}

			function buildGalleryArray(xhr) {
				g = JSON.parse(xhr.response.replace(/(\s*{\s*|\s*,\s*)(['"])?(\w+)(['"])?:/g, '$1"$3":'));
				console.log(g);
				let s = g.filter(v => !v.type);
				g = g.filter(v => v.type);
				let out = "";
				for (let i of s) {out += `${i.name}<br>`;
				document.getElementById('general').innerHTML = out;
			}

			function loadGallery(i) {
				
			}
		</script>
	</body>
</html>
